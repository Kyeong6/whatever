# 업무내용

- 개발 수정사항 반영하여 로직 변경 진행

## 8/12

### 워크플로

**변경사항**

지난 주에 정리한 변경 사항은 다음과 같다.

알림용 텍스트파일 같은 경우 작업자(operator)에게 이상치 알림을 주기 때문에 이상치 알림 전용 텍스트파일이라고 할 수 있고, 서버용 텍스트파일 같은 경우 최종적으로 모바일 어플리케이션을 구축하기 때문에 10분마다 업데이트하기 위한 전달 프로토콜이다.

- Mini PC에서 이상치와 예측에 관한 기능 수행 후 알림용(1 min) / 서버용(10 min) txt 파일 구성
- 작업 주기 정리
    - 1 min : 알림용
        - 센서 데이터 수집 → 실측값 테이블 적재 → 이상치 검출 → 검출 결과 DB 적재 → 알림 / 서버용 txt 파일 구성(data/sensor/alert.txt, data/sensor/server.txt)
        - 서버 실행 후 1년이 지날 경우 데이터 삭제(해당 시간 - 365 day)
    - 10 min : 서버용
        - 1 min 작업에서 서버용 텍스트 파일을 분마다 구성하고 있고, 만약 1 hr 작업이 수행된다면 예측 속성에 값 넣기(정각이 아닌 경우는 예측 속성 값 NULL)
    - 1 hr : 예측용
        - 실측값 테이블 조회(60 rows) → csv 변환 수행(input) → LSTM 예측 수행 → 예측값 DB 적재 → 예측값 서버용 텍스트파일 구성
    - 3 mon : 이상치 기준 설정
        - 실측값 및 야간 유량 테이블 조회 → 이상치 기준 설정 및 변경
    - 1 hr : 학습용
        - 실측값 테이블 조회(1 yr) → LSTM 학습 수행(데이터 전처리 → 학습) → 모델 파일, 스케일러 파일 저장(output/Learning_lstm/flow_rate, output/Learning_lstm/pressure)

**최종 워크플로 도식화**

![workflow](https://github.com/user-attachments/assets/46f2fa38-51a4-4f5e-989f-6c8f84b02d78)